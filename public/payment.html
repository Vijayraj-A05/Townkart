<!DOCTYPE html>
<html lang="en" style="scroll-behavior: smooth;">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TownKart | Payment</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* General styles and animations */
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    @keyframes fadeInDown {
      0% { opacity: 0; transform: translateY(-30px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    @keyframes slideLine {
      0% { width: 40px; background: linear-gradient(to right, #6a11cb, #2575fc); }
      100% { width: 100px; background: linear-gradient(to right, #2575fc, #6a11cb); }
    }
    @keyframes slideInUp {
      0% { transform: translateY(100%); opacity: 0; }
      100% { transform: translateY(0); opacity: 1; }
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #f6f8ff 0%, #e8eeff 100%);
      color: #2d3436;
    }
    .payment-card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.08);
      padding: 30px;
      max-width: 600px;
      margin: 50px auto;
      animation: fadeInDown 0.5s ease-out forwards;
    }
    .payment-options-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }
    .payment-option-card {
      background: #e9f0ff;
      border: 2px solid transparent;
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .payment-option-card:hover {
      background: #d3e0ff;
      transform: scale(1.02);
    }
    .payment-option-card.active {
      border-color: #1A73E8;
      background: #f0f6ff;
    }
    .payment-option-card img {
      height: 40px;
      margin-bottom: 10px;
      max-width: 100%;
      object-fit: contain;
    }
    .payment-form {
      display: none;
    }
    .payment-form.visible {
      display: block;
    }
    .payment-form .form-group {
      margin-bottom: 20px;
    }
    .payment-form label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: #555;
    }
    .payment-form input {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
      transition: all 0.3s ease;
    }
    .payment-form input:focus {
      outline: none;
      border-color: #1A73E8;
      box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.1);
    }
    .payment-method-details {
      display: none;
      text-align: center;
      margin-top: 20px;
    }
    .payment-method-details.visible {
      display: block;
    }
    .payment-qr-code {
      max-width: 200px;
      height: auto;
      margin-top: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    #notification-toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: rgba(26, 115, 232, 0.95);
      color: white;
      padding: 15px 25px;
      border-radius: 8px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      animation: slideInUp 0.5s ease-out forwards;
      z-index: 1000;
      display: flex;
      align-items: center;
      gap: 10px;
      opacity: 0;
    }
  </style>
</head>
<body>
  <header id="main-header" style="background: white; box-shadow: 0 2px 10px rgba(0,0,0,0.08); padding: 15px 20px; position: sticky; top: 0; z-index: 100; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 15px; transition: all 0.3s ease;">
    
    <div style="display: flex; align-items: center; min-width: 120px;">
      <div style="display: flex; align-items: center; font-weight: 700; font-size: clamp(18px, 4vw, 24px); color: #1A73E8;">
        <span style="background: linear-gradient(to right, #1A73E8, #6C5CE7); width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-right: 10px; color: white;">TK</span>
        <span>TownKart</span>
      </div>
    </div>
    
    <div style="display: flex; justify-content: center; flex: 1; min-width: 200px; max-width: 600px; margin: 0 10px;">
      <div style="position: relative; width: 100%;">
        <input type="text" placeholder="Search products, brands and categories..." style="padding: 12px 15px 12px 45px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; width: 100%; transition: all 0.3s ease;" onfocus="this.style.borderColor='#1A73E8'; this.style.boxShadow='0 0 0 3px rgba(26, 115, 232, 0.1)'" onblur="this.style.borderColor='#ddd'; this.style.boxShadow='none'">
        <i class="fas fa-search" style="position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: #1A73E8;"></i>
        <button style="position: absolute; right: 5px; top: 50%; transform: translateY(-50%); background: #1A73E8; color: white; border: none; padding: 8px 15px; border-radius: 6px; font-weight: 500; cursor: pointer; transition: background 0.3s ease;" onmouseover="this.style.background='#0d47a1'" onmouseout="this.style.background='#1A73E8'">Search</button>
      </div>
    </div>
    
    <div style="display: flex; align-items: center; justify-content: flex-end; gap: clamp(10px, 3vw, 20px); min-width: 180px;">
      <div id="wishlist-icon-container" style="position: relative; display: flex; flex-direction: column; align-items: center; cursor:pointer;">
        <i class="fas fa-heart" style="font-size: 22px; color: #1A73E8; transition: color 0.3s ease;" onmouseover="this.style.color='#FF6F00'" onmouseout="this.style.color='#1A73E8'"></i>
        <span style="font-size: 12px; margin-top: 4px; color: #2d3436; display: none;" class="label">Wishlist</span>
        <span id="wishlist-count" style="position: absolute; top: -8px; right: 5px; background: #FF6F00; color: white; border-radius: 50%; width: 18px; height: 18px; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 600;">0</span>
      </div>
      
      <div id="cart-icon-container" style="position: relative; display: flex; flex-direction: column; align-items: center; cursor:pointer;">
        <i class="fas fa-shopping-cart" style="font-size: 22px; color: #1A73E8; transition: color 0.3s ease;" onmouseover="this.style.color='#FF6F00'" onmouseout="this.style.color='#1A73E8'"></i>
        <span style="font-size: 12px; margin-top: 4px; color: #2d3436; display: none;" class="label">Cart</span>
        <span id="cart-count" style="position: absolute; top: -8px; right: 0; background: #1A73E8; color: white; border-radius: 50%; width: 18px; height: 18px; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 600;">0</span>
      </div>
      
      <div id="profile-container" style="display: flex; flex-direction: column; align-items: center; cursor:pointer; position: relative;">
        <div id="profile-avatar" style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(to right, #1A73E8, #6C5CE7); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600;">JD</div>
        <span style="font-size: 12px; margin-top: 4px; color: #2d3436; display: none;" class="label">Profile</span>
      </div>
    </div>
  </header>

  <main style="max-width: 1200px; margin: 30px auto; padding: 0 20px;">
    <div class="payment-card">
      <h2 style="text-align: center; color: #1A73E8; margin-bottom: 30px; display: flex; align-items: center; justify-content: center; gap: 10px;">
        <i class="fas fa-lock" style="font-size: 24px;"></i> Secure Payment
      </h2>
      
      <div class="payment-options-grid">
        <div class="payment-option-card active" data-payment-method="card">
          <img src="https://cdn-icons-png.flaticon.com/512/179/179431.png" alt="Credit/Debit Card" style="height: 40px;">
          <h4 style="margin: 0; font-weight: 500;">Card</h4>
        </div>
        <div class="payment-option-card" data-payment-method="gpay">
          <img src="https://cdn-icons-png.flaticon.com/512/300/300221.png" alt="Google Pay" style="height: 40px;">
          <h4 style="margin: 0; font-weight: 500;">GPay</h4>
        </div>
        <div class="payment-option-card" data-payment-method="rupay" style="display: flex; align-items: center; gap: 10px; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
  <img src="/mnt/data/A_digital_vector_image_showcases_a_RuPay_payment_m.png" alt="Rupay" style="height: 40px; width: auto; border-radius: 5px;">
  <h4 style="margin: 0; font-weight: 500;">Rupay</h4>
</div>

        <div class="payment-option-card" data-payment-method="upi">
          <img src="https://cdn-icons-png.flaticon.com/512/761/761757.png" alt="UPI" style="height: 40px;">
          <h4 style="margin: 0; font-weight: 500;">UPI</h4>
        </div>
      </div>

      <div id="payment-forms">
        <!-- Card Payment Form -->
        <form id="card-form" class="payment-form visible">
          <div class="form-group">
            <label for="cardholder-name">Cardholder Name</label>
            <input type="text" id="cardholder-name" placeholder="John Doe" required>
          </div>
          <div class="form-group">
            <label for="card-number">Card Number</label>
            <input type="text" id="card-number" placeholder="0000 0000 0000 0000" required>
          </div>
          <div style="display: flex; gap: 20px;">
            <div class="form-group" style="flex: 1;">
              <label for="expiry-date">Expiry Date</label>
              <input type="text" id="expiry-date" placeholder="MM/YY" required>
            </div>
            <div class="form-group" style="flex: 1;">
              <label for="cvv">CVV</label>
              <input type="text" id="cvv" placeholder="123" required>
            </div>
          </div>
          <div style="display: flex; align-items: center; margin-top: 10px;">
            <i class="fas fa-shield-alt" style="color: #1A73E8; margin-right: 10px;"></i>
            <span style="font-size: 14px; color: #666;">Your payment details are securely encrypted</span>
          </div>
        </form>

        <!-- GPay Payment Form -->
        <div id="gpay-form" class="payment-form">
          <div class="form-group">
            <label for="gpay-upi-id">UPI ID</label>
            <input type="text" id="gpay-upi-id" placeholder="yourname@gpay" required>
          </div>
          <div class="payment-method-details">
            <p style="color: #666; font-size: 14px;">Scan the QR code to complete payment with Google Pay</p>
            <img class="payment-qr-code" src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=GooglePayPaymentTownKart12345" alt="QR Code for GPay">
            <p style="color: #888; font-size: 12px; margin-top: 10px;">Scan this QR code using your Google Pay app</p>
          </div>
        </div>
        
        <!-- Rupay Payment Form -->
        <form id="rupay-form" class="payment-form">
  <div class="form-group">
    <label for="rupay-card-number">Enter Rupay Card Number</label>
    <input type="text" id="rupay-card-number" placeholder="0000 0000 0000 0000" required>
  </div>

  <div style="display: flex; gap: 20px;">
    <div class="form-group" style="flex: 1;">
      <label for="rupay-expiry-date">Expiry Date</label>
      <input type="text" id="rupay-expiry-date" placeholder="MM/YY" required>
    </div>
    <div class="form-group" style="flex: 1;">
      <label for="rupay-cvv">CVV</label>
      <input type="text" id="rupay-cvv" placeholder="123" required>
    </div>
  </div>

  <!-- Secure info line -->
  <div style="display: flex; align-items: center; margin-top: 10px;">
    <!-- Replace icon with image -->
    <i class="fas fa-shield-alt" style="color: #1A73E8; margin-right: 10px;"></i>
    <span style="font-size: 14px; color: #666;">Your payment details are securely encrypted</span>
  </div>
</form>


        <!-- UPI Payment Form (generic) -->
        <div id="upi-form" class="payment-form">
          <div class="form-group">
            <label for="upi-id">Enter UPI ID</label>
            <input type="text" id="upi-id" placeholder="yourname@bank" required>
          </div>
          <div class="payment-method-details">
            <p style="color: #666; font-size: 14px;">Scan the QR code to complete payment with any UPI app</p>
            <img class="payment-qr-code" src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=UPIPaymentTownKart67890" alt="QR Code for UPI">
            <p style="color: #888; font-size: 12px; margin-top: 10px;">Scan this QR code using any UPI supported app</p>
          </div>
        </div>
      </div>

      <div style="text-align: center; margin-top: 30px;">
        <button id="pay-now-button" style="background: #1A73E8; color: white; border: none; padding: 15px 40px; border-radius: 8px; font-weight: 600; font-size: 18px; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; gap: 10px; margin: 0 auto;" onmouseover="this.style.background='#0d47a1'" onmouseout="this.style.background='#1A73E8'">
          <i class="fas fa-lock"></i> Pay Now
        </button>
        <p style="color: #888; font-size: 12px; margin-top: 15px; display: flex; align-items: center; justify-content: center; gap: 8px;">
          <i class="fas fa-shield-alt"></i> All transactions are secure and encrypted
        </p>
      </div>
    </div>
  </main>

  <footer style="background: #2d3436; color: white; padding: 40px 0; margin-top: 60px;">
    <div style="max-width: 1200px; margin: 0 auto; padding: 0 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 30px;">
      <div>
        <h3 style="color: #1A73E8; margin-bottom: 20px;">TownKart</h3>
        <p style="line-height: 1.6; opacity: 0.8;">Your one-stop shop for all your needs. Quality products at affordable prices.</p>
      </div>
      <div>
        <h4 style="margin-bottom: 15px;">Quick Links</h4>
        <ul style="list-style: none; padding: 0; margin: 0; line-height: 2;">
          <li><a href="#" style="color: white; text-decoration: none; opacity: 0.8; transition: opacity 0.3s ease;" onmouseover="this.style.opacity='1'" onmouseout="this.style.opacity='0.8'">Home</a></li>
          <li><a href="#" style="color: white; text-decoration: none; opacity: 0.8; transition: opacity 0.3s ease;" onmouseover="this.style.opacity='1'" onmouseout="this.style.opacity='0.8'">Products</a></li>
          <li><a href="#" style="color: white; text-decoration: none; opacity: 0.8; transition: opacity 0.3s ease;" onmouseover="this.style.opacity='1'" onmouseout="this.style.opacity='0.8'">Categories</a></li>
          <li><a href="#" style="color: white; text-decoration: none; opacity: 0.8; transition: opacity 0.3s ease;" onmouseover="this.style.opacity='1'" onmouseout="this.style.opacity='0.8'">About Us</a></li>
        </ul>
      </div>
      <div>
        <h4 style="margin-bottom: 15px;">Contact Us</h4>
        <p style="opacity: 0.8; margin-bottom: 10px;"><i class="fas fa-map-marker-alt" style="margin-right: 10px;"></i> 123 Shopping Street, Retail City</p>
        <p style="opacity: 0.8; margin-bottom: 10px;"><i class="fas fa-phone" style="margin-right: 10px;"></i> +1 234 567 8900</p>
        <p style="opacity: 0.8;"><i class="fas fa-envelope" style="margin-right: 10px;"></i> support@townkart.com</p>
      </div>
      <div>
        <h4 style="margin-bottom: 15px;">Newsletter</h4>
        <p style="opacity: 0.8; margin-bottom: 15px;">Subscribe to get special offers and updates</p>
        <div style="display: flex;">
          <input type="email" placeholder="Your email" style="padding: 12px 15px; border: none; border-radius: 6px 0 0 6px; width: 70%;">
          <button style="background: #1A73E8; color: white; border: none; padding: 12px 15px; border-radius: 0 6px 6px 0; cursor: pointer; transition: background 0.3s ease;" onmouseover="this.style.background='#0d47a1'" onmouseout="this.style.background='#1A73E8'">Subscribe</button>
        </div>
      </div>
    </div>
    <div style="text-align: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
      <p style="opacity: 0.7;">&copy; 2023 TownKart. All rights reserved.</p>
    </div>
  </footer>

  <div id="notification-toast"></div>

  <!-- small profile menu for payment page -->
  <div id="profile-menu" style="display:none; position: absolute; top: 70px; right: 20px; z-index:999; background:white; border-radius:8px; box-shadow:0 4px 15px rgba(0,0,0,0.1); min-width:220px;">
    <div style="padding:12px 16px; border-bottom:1px solid #eee; display:flex; gap:10px; align-items:center;">
      <img id="profile-photo" src="" alt="Profile" style="width:48px;height:48px;border-radius:50%;object-fit:cover;background:#f0f0f0;">
      <div>
        <div id="profile-name" style="font-weight:700;color:#2d3436;">Guest</div>
        <div id="profile-email" style="font-size:12px;color:#666;">guest@townkart</div>
      </div>
    </div>
    <div style="padding:10px 12px;">
      <div style="margin-bottom:8px;"><strong>Address:</strong>
        <div id="profile-address" style="font-size:13px;color:#555">Not set</div>
      </div>
      <div style="margin-bottom:8px;"><strong>Orders:</strong> <span id="orders-count">0</span></div>
      <a href="auth.html" style="display:block;padding:8px 10px;border-radius:6px;background:#1A73E8;color:white;text-align:center;text-decoration:none;margin-bottom:8px;">Manage Account</a>
      <button id="signout-btn" style="width:100%;padding:8px;border-radius:6px;border:none;background:#FF6F00;color:white;cursor:pointer;">Sign Out</button>
    </div>
  </div>

  <script>
    function showNotification(message, isError = false) {
      const notificationToast = document.getElementById('notification-toast');
      notificationToast.style.opacity = '1';
      notificationToast.style.transform = 'translateY(0)';
      notificationToast.innerHTML = `<i class="fas ${isError ? 'fa-exclamation-circle' : 'fa-check-circle'}"></i> ${message}`;
      
      const cartIcon = document.querySelector('.fa-shopping-cart');
      cartIcon.style.animation = 'pulse 0.5s';
      
      if (isError) {
          notificationToast.style.background = 'rgba(255, 0, 0, 0.8)';
      } else {
          notificationToast.style.background = 'rgba(26, 115, 232, 0.95)';
      }
      
      setTimeout(() => {
        notificationToast.style.opacity = '0';
        notificationToast.style.transform = 'translateY(100%)';
        setTimeout(() => {
          cartIcon.style.animation = '';
        }, 500);
      }, 2000);
    }

    document.getElementById('pay-now-button').addEventListener('click', (e) => {
      e.preventDefault();
      
      const activeFormId = document.querySelector('.payment-option-card.active').getAttribute('data-payment-method');
      const activeForm = document.getElementById(`${activeFormId}-form`);
      let isValid = true;
      let isCardForm = (activeFormId === 'card' || activeFormId === 'rupay');

      if (isCardForm) {
        const cardholderName = document.getElementById(activeFormId === 'card' ? 'cardholder-name' : 'rupay-card-number').value;
        const cardNumber = document.getElementById(activeFormId === 'card' ? 'card-number' : 'rupay-card-number').value;
        const expiryDate = document.getElementById(activeFormId === 'card' ? 'expiry-date' : 'rupay-expiry-date').value;
        const cvv = document.getElementById(activeFormId === 'card' ? 'cvv' : 'rupay-cvv').value;

        if (!cardholderName || !cardNumber || !expiryDate || !cvv) {
          isValid = false;
        }
      } else {
        const upiId = document.getElementById(activeFormId === 'gpay' ? 'gpay-upi-id' : 'upi-id').value;
        if (!upiId) {
          isValid = false;
        }
      }
      
      if (isValid) {
        showNotification('Payment successful! Redirecting to order confirmation...');
        // Simulate payment processing
        setTimeout(() => {
          window.location.href = "#order-confirmation"; // In a real app, this would redirect to a confirmation page
        }, 1500);
      } else {
        showNotification('Please fill in all the required details!', true);
      }
    });

    document.querySelectorAll('.payment-option-card').forEach(card => {
      card.addEventListener('click', () => {
        document.querySelectorAll('.payment-option-card').forEach(c => c.classList.remove('active'));
        card.classList.add('active');
        
        document.querySelectorAll('.payment-form').forEach(form => form.classList.remove('visible'));
        const paymentMethod = card.getAttribute('data-payment-method');
        document.getElementById(`${paymentMethod}-form`).classList.add('visible');

        document.querySelectorAll('.payment-method-details').forEach(details => details.classList.remove('visible'));
        if (paymentMethod === 'gpay' || paymentMethod === 'upi') {
            document.getElementById(`${paymentMethod}-form`).querySelector('.payment-method-details').classList.add('visible');
        }
      });
    });
  </script>
  
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBi5Yd7oqhRoo4ATEb78U3POkeJrCbDUTU",
      authDomain: "townkart-d604a.firebaseapp.com",
      projectId: "townkart-d604a",
      storageBucket: "townkart-d604a.appspot.com",
      messagingSenderId: "223214079906",
      appId: "1:223214079906:web:9f78fdeda7a23623252cfb",
      measurementId: "G-5P8CF04MFC"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const profileContainer = document.getElementById('profile-container');
    const profileMenu = document.getElementById('profile-menu');

    if (profileContainer) {
      profileContainer.addEventListener('click', () => {
        profileMenu.style.display = profileMenu.style.display === 'block' ? 'none' : 'block';
      });
    }

    onAuthStateChanged(auth, async (user) => {
      const nameEl = document.getElementById('profile-name');
      const emailEl = document.getElementById('profile-email');
      const photoEl = document.querySelector('#profile-menu #profile-photo');
      const addrEl = document.getElementById('profile-address');
      const ordersEl = document.getElementById('orders-count');
      if (!nameEl) return;

      if (user) {
        emailEl.textContent = user.email || '';
        nameEl.textContent = user.displayName || 'User';
        if (user.photoURL && photoEl) photoEl.src = user.photoURL;
        try {
          const snap = await getDoc(doc(db, 'users', user.uid));
          if (snap.exists()) {
            const data = snap.data();
            if (data.photoURL && photoEl && !user.photoURL) photoEl.src = data.photoURL;
            addrEl.textContent = data.address || 'Not set';
            const orders = data.orders || [];
            ordersEl.textContent = Array.isArray(orders) ? orders.length : (data.ordersCount || 0);
          }
        } catch (e) { console.error('profile load:', e); }
      } else {
        nameEl.textContent = 'Guest';
        emailEl.textContent = '';
        if (photoEl) photoEl.src = '';
        addrEl.textContent = 'Not set';
        ordersEl.textContent = '0';
      }
    });

    const signoutBtn = document.getElementById('signout-btn');
    if (signoutBtn) {
      signoutBtn.addEventListener('click', async () => {
        try {
          await signOut(auth);
          window.location.href = 'auth.html';
        } catch (e) { console.error('signout', e); }
      });
    }
  </script>
</body>
</html>